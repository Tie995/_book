<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>组织与管理研究的实证方法</title>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <script src="libs/header-attrs-2.25/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="zh-CN.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# 组织与管理研究的实证方法
]
.subtitle[
## 实操课：从入门到进阶
]
.author[
### 
]

---


layout: true

&lt;div class="TIE-copyright"&gt;&lt;/div&gt;   

---
# 自我介绍

- 王子婧，华中科技大学管理学院博士研究生。

- 萜 [tiē] 妹，公众号“萜心话”运营者。

- 撰写《如何进行文献阅读》、《如何搭建学术库》等推送，阅读量50000+。熟悉结构方程模型、定性比较分析、多项式回归等研究方法，制作《QCA 全过程视频教程》《保姆级毕业论文实操教程》等教程，播放量 30000+。

- 个人学术网站：[https://tie-blog.netlify.app](https://tie-blog.netlify.app/)

---


.pull-left[
## Day 1

#### 09:00-10:15 

- 论文项目的全流程速览

#### 10:30-11:45   

- 前期准备与基础介绍

#### 14:00-15:15

- 被调节的中介与被中介的调节

#### 15:30-16:45

- 三项交互与U型模型

#### 17:00-18:00

- 数据练习与答疑

]


.pull-right[
## Day 2

#### 09:00-10:15 

- 跨层模型的基本介绍

#### 10:30-11:45   

- 常见跨层模型的假设检验

#### 14:00-15:15

- 跨层模型的数据分析全流程

#### 15:30-16:45

- 社会关系模型

#### 17:00-18:00

- 数据练习与答疑

]

---
class: inverse, middle, center

# 论文项目的全流程速览

 

---


## 如何独立撰写一篇论文？

具体步骤：

- 确定研究问题，建立研究模型

- 进行研究设计，收集研究数据

- 清洗原始数据，完成数据筛选

- 进行数据分析，验证研究模型

- 汇报研究结果，撰写论文初稿


以下示例基于：

&gt; Heng, Y. T., &amp; Fehr, R. (2022). When you try your best to help but don’t succeed: How self-compassionate reflection influences reactions to interpersonal helping failures. Organizational Behavior and Human Decision Processes, 171. https://doi.org/10.1016/j.obhdp.2022.104151


---

## 研究问题与模型构建

研究问题：员工对帮助失败有何反应？


研究模型：

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151008227.png)

---

## 研究设计与量表选择
.pull-left[他人论文
- 顶刊论文

- 综述论文

- 博士论文

量表网站
- [OBHRM百科](http://www.obhrm.net/index.php?title=栏目:研究量表&amp;pageuntil=Group+Integration+Scale+团队整合量表&amp;subcatfrom=groupmessage&amp;filefrom=groupmessage#mw-pages)

工具书
- 《人力资源管理研究与实践：前沿量表手册》

- 《管理研究量表手册》]

.pull-right[

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151010274.png)]


---

## 数据清洗

在线问卷导出的原始数据通常难以直接调用。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312141744732.png)

--

我们第一步需要手动对响应题项进行替换。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151011579.png)

---

## 数据预处理

通常计算各变量均值，将其视为变量得分。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151526139.png)


---

## 有效性分析

.pull-left[
信度分析

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151019103.png)]

--

.pull-right[
效度分析（e.g. 验证性因子分析）
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151020493.png)]

--

描述性统计与相关分析
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151022447.png)

---
## 假设检验

- H1a. After a helping failure, self-compassion is negatively related to guilt.

- H1b. After a helping failure, self-compassion has a negative indirect effect on future helping through guilt.

- H2a. After a helping failure, self-compassion is positively related to helping self-efficacy.

- H2b. After a helping failure, self-compassion has a positive indirect effect on future helping through helping self-efficacy.

- H3a. The indirect negative effect of self-compassion on future helping through guilt will be stronger when coworker blame attribution is low.

- H3b. The indirect positive effect of self-compassion on future helping through helping self-efficacy will be stronger when coworker blame attribution is low.


---
## 假设检验

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151604765.png)

--

.center[![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151601323.png)]

---

## 如何独立撰写一篇论文？

具体步骤：

- 确定研究问题，建立研究模型

- 进行研究设计，收集研究数据

- .red[清洗原始数据，完成数据筛选]

- .red[进行数据分析，验证研究模型]

- 汇报研究结果，撰写论文初稿

- ……


---
class: inverse, middle, center

# 单层数据分析的全流程实操

 

---

## 数据清洗

数据配对（多时点、多来源）

- 可在Excel中利用Vlookup函数进行指定内容匹配

缺失值
- 在线问卷可通过设置避免缺失值

- 纸质问卷若出现大量缺失值需舍弃

未通过注意力检验

- 可设置注意力检验题目，如【该题项请选非常同意】等清洗未认真作答的问卷


---

## 计算变量得分（SPSS按键版）


1. 【转化】-【计算变量】

1.  目标变量，输入：x

1.  函数组，选择【Mean】

1.  数字表达式(E)，选择x1-x4


![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312142212745.png)

---

## 批量计算变量得分（SPSS语法版）


```sql
COMPUTE x=Mean(x1,x2,x3,x4).
EXECUTE.
```

比如我们要把整个问卷变量化，就可以不断替换语法里的x，然后一次性完成（用Word替换或者手动替换都可以）。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112321828.png)


---

## 批量计算变量得分（Excel）

我们可以利用AVERAGEIF公式，批量获得满足特定条件数组的均值。

```Excel
=AVERAGEIF(IF的判断区域，IF的判定依据，数据的计算区域)
```
![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322634.png)

---

## 批量计算变量得分（Excel）

```Excel
=AVERAGEIF(IF的判断区域，IF的判定依据，数据的计算区域)
```

.red[IF的判断区域]：所有原始题项的标题行。

- 为了便于公式的横向拖动，我们最好将横竖都固定，即在字母和数字前都加上$，如$S$1:$AE$1。


.red[IF的判断依据]：以目标变量名开头。

- Teat()公式可以直接提取单元格文本，再加上一个通配符“*”，即可批量识别。

- 同样，为了拖动方便，我们要将Text里的文本，固定在第1行，而不固定列，如AF$1。


.red[数据的计算区域]：每个被试的得分行。

- 因为每行都是一个被试，所以要固定列，而不固定行，如$S2:$AE2。

---

## 批量计算变量得分（Excel）

```Excel
=AVERAGEIF($S$1:$AE$1,TEXT(AF$1,)&amp;"*",$S2:$AE2)
```

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322692.png)

在第一个被试的第一个变量格中输入上述函数，再横向、竖向拖动，即可得到所有被试的全部变量。

--

.footnote[这里的操作原理是将原始题项按【变量名+序号】命名，再用【变量名】进行匹配。所以，.red[变量名绝对不能有重叠]！！！]


---
## 计算团队平均值（Excel）

团队变量的计算也是利用AVERAGEIF公式，只是从横向判断变为了纵向判断。

在目标单位格中输入公式，再横向、纵向填充。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322692.png)

---

## 计算团队平均值（Excel）

```Excel
=AVERAGEIF($A$2:$A$36,$A2,AF$2:AF$36)
```

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322770.png)


---
## 计算团队标准差（Excel）

现在有些研究还要计算团队标准差，但Excel并没有自带标准差的IF公式，所以需要一个复合公式。

```Excel
=STDEV.S(IF(IF的判断条件,数据的计算区域,""))
```

代入我们的例子中：

```Excel
=STDEV.S(IF($A$2:$A$36=$A2,AF$2:AF$36,""))
```

上述IF公式用于得到满足条件的数组。

- 如果满足我们的条件，就返回对应数值；
- 如果不满足我们的条件，则会形成空值。

这些数据最终会形成数组。

---
## 计算团队标准差（Excel）

最后用STDEV.S计算数组的标准差。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322812.png)

因为我们这里涉及数组的处理，所以输入完公式后，不可以只按【Enter】，要.red[同时按住【Shift+Ctrl+Enter】]才行。

可以发现，最终公式前后会有一个{}（这不可以手打）。

---


## 有效性分析

.pull-left[
信度分析

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151019103.png)]


.pull-right[
效度分析（e.g. 验证性因子分析）
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151020493.png)]


描述性统计与相关分析
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151022447.png)

---

## 信度分析（SPSS按键版）

- 【分析(A)】-【度量(S)】-【可靠性分析(R)】

- 模型选择：【α】➔将目标题项从左侧拖入右侧项目框➔点击【确定】。


![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312142224647.png)


---

## 信度分析（SPSS语法版）


```sql
RELIABILITY

 /VARIABLES=x1 x2 x3 x4

 /SCALE('ALL VARIABLES') ALL

 /MODEL=ALPHA.
```

需多次计算时，将语句复制多遍进行修改即可。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112321842.png)


---


## 验证性因子分析（Mplus）

.pull-left[

- 基准模型语句

```Mplus
TITLE: CFA
DATA: FILE IS 1.dat;
VARIABLE: 
NAMES ARE id x1-x3 m1-m3 
y1-y4;
Usevariables ARE x1-x3 m1-m3 
y1-y4;
MODEL:
  x by  x1-x3;
  m by  m1-m3;
  y by  y1-y4;
OUTPUT: Standardized；
```
    ]

.pull-right[
- 双因子模型语句
```Mplus
TITLE: CFA
DATA: FILE IS 1.dat;
VARIABLE: 
NAMES ARE id x1-x3 m1-m3 
y1-y4;
Usevariables ARE x1-x3 m1-m3 
y1-y4;
MODEL:
*x by  x1-x3 m1-m3;
  y by  y1-y4;
OUTPUT: Standardized；
```]


---


## Mplus：文件格式


 .pull-left[
  
Mplus主要涉及的文件格式有三种.
- 输入文件为input，在编写语句时保存后才可以运行；

- 输出文件为output；

- 数据文件为dat或txt，建议和input文件放在同一个文件夹

]

.pull-right[
![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112321058.png)]

---


## Mplus：格式转换


由于Mplus只能打开ASCII格式的文件（.dat和.txt），所以SPSS常用的.sav格式的文件无法被读取，我们要先将数据进行转化。

.pull-left[
①打开SPSS软件，选择：文件-另存为；


②一般情况下，可选择“以制表符分隔”，数据量较大时，可选择“固定ASCII格式”；

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112321167.png)]


.pull-right[

③注意不要勾选“将变量名写入表格”；

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112321248.png)

④点击保存即可。

]


---

## Mplus：语句说明

```Mplus
TITLE: example
```
自己给当前数据分析程序取个名称，无要求。

```Mplus
DATA:File is c：/mplus/example.dat;
```
用于指定数据文件存放的位置。

如果.dat和.inp在同一个文件夹，可以直接输入文件名字；如果不在同一个文件夹中，就只能输入储存路径。

---

## Mplus：语句说明

```Mplus
VARIABLE: 

Names are ID X1 X2 X3 Y1 Y2 Y3 Z1 Z2 Z3;
```

定义数据文件中的变量。数据文件中所有变量，一个个给它命名。
```Mplus
Usevariables are ID X1 X2 X3 Y1 Y2 Y3;
```
选择稍后分析时，需要使用的变量。

```Mplus
Missing are all (999);
```
所有的缺失值都用999来表示。


```Mplus
Define: int=x*w;
```
Define命令可以生成新的变量。


---

## Mplus：语句说明
```Mplus
CLUSTER is ID
```
按ID进行分组。

```Mplus
Within: X1 X2 X3;
```
用于两水平模型中定义组内水平变量。
```Mplus
BETWEEN: Y1 Y2 Y3;
```
用于两水平模型中定义组间水平变量。

```Mplus
CENTER w (GRANDMEAN)；
CENTER x (GROUPMEAN)；
```
进行群体或组内中心化。

---

## Mplus：语句说明

Analysis:

Type = 

- general; ！默认分析类型

-  twolevel; ! 两层模型

- complex; ！混合模型



Estimator = 

- ML;！极大似然估计(Maximum Likelihood)，当因变量为连续变量时，为Mplus默认参数估计方法；

- MLM;！极大似然估计伴标准误和均值矫正的卡方检验，适用于非正态数据；

- MLR;！稳健极大似然估计，适用于复杂数据结构，与Type=complex合用；

- WLS;！加权最小二乘法估计。


---


## Mplus：语句说明

常用的字符（红字）及其代表关系如下：

- .red[BY]：定义潜变量，如：f1 BY x1-x3;即因子f1由x1、x2、x3三个显变量测量；

- .red[ON]：定义回归关系，如：f1 ON x1-x3;即可用x1、x2、x3三个变量预测f1；

- .red[WITH]：定义相关关系，如：f1 WITH f2;即因子f1与f2相关；

- .red[List of Variables]：定义变量方差和残差方差，如：X Y M; 当变量为自变量时表示方差，当变量为因变量时便是残差方差；

- .red[[List of Variables]]：定义均值、截距，如：[X Y M];估计X Y M的截距；

- .red[@]：固定参数，如：f1@1;即固定因子f1方差为1；

- .red[(name)]：命名某参数，如：M ON X(a);即X对M的回归系数命名为a；

- .red[丨]：定义随机效应变量，与ANALYSIS中的TYPE=RANDOM连用分析随机系数模型，如：s丨y1 ON x1;即s代表随机回归系数；

---


## Mplus：语句说明
MODEL INDIRECT：描述间接效应；

- .red[IND]：定义间接效应，ind左边为因变量，右边最后一个为自变量，右边其他变量为中介变量，如：Y IND M X;表示自变量X通过中间变量M对因变量Y的间接效应；

- .red[VIA]：描述一组包含特定中介变量的间接效应，与ind相似，左边为因变量，右边最后一个为自变量，右边其他变量为中介变量，VIA指定的是所有经过中介变量由自变量到因变量的间接效应；

MODEL CONSTRAINT：模型设定命令；

- .red[NEW]：对设定命令中需要使用的新变量命名，生成数据文件中并未出现过的变量，如：NEW(c)；c=a*b;即c为a、b的交互项。

---


## Mplus：语句说明

常用的Output命令（红字）如下：

- .red[SAMPSTAT]：连续变量时要求报告均值、方差、协方差和相关系数；

- .red[STANDARDIZED]：报告标准化结果，常见的三种标准化结果分别为：STDYX、STDY、STD；

- .red[MODINDICES]：报告模型修正指数和期望参数变化指数；

- .red[CINTERVAL]：报告参数置信区间；

Mplus还有14个技术报告分别是TECH1-14，详见[Mplus用户手册](http://www.statmodel.com/download/usersguide/Chapter18.pdf)。

- .red[Tech1]：报告参数的设置有多少个，自由估计参数开始值等等；

- .red[Tech3]：报告估计的协方差和相关矩阵，注意这里是估计的，而不是样本的；

- .red[Tech4]：报告模型中潜变量的均值，协方差和相关系数等，而不是sampstat中提供的连续结果变量的均值。



---


## 验证性因子分析（Mplus）

.pull-left[

- 基准模型语句

```Mplus
TITLE: CFA
DATA: FILE IS 1.dat;
VARIABLE: 
NAMES ARE id x1-x3 m1-m3 
y1-y4;
Usevariables ARE x1-x3 m1-m3 
y1-y4;
MODEL:
  x by  x1-x3;
  m by  m1-m3;
  y by  y1-y4;
OUTPUT: Standardized；
```
    ]

.pull-right[
- 双因子模型语句
```Mplus
TITLE: CFA
DATA: FILE IS 1.dat;
VARIABLE: 
NAMES ARE id x1-x3 m1-m3 
y1-y4;
Usevariables ARE x1-x3 m1-m3 
y1-y4;
MODEL:
*x by  x1-x3 m1-m3;
  y by  y1-y4;
OUTPUT: Standardized；
```]


---

## 验证性因子分析判断标准

.center[![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312131707606.png)]

---

## 相关分析（SPSS按键版）

- 【分析】-【相关】-【双相关(B)】；

- 将目标题项从左侧拖入右侧项目框➔点击【确定】，得结果。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151034752.png)

.footnote[可以在得结果之前，点击右侧【选项】，勾选【均值和标准差】，这样结果中也会报告。就可以不用单独进行均值和标准差的计算。]


---

## 相关分析（SPSS语法版）

```sql
CORRELATIONS

 /VARIABLES=x m y w

 /PRINT=TWOTAIL NOSIG

 /STATISTICS DESCRIPTIVES

 /MISSING=PAIRWISE.
```

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151022447.png)

---

## 假设检验

- H2a. After a helping failure, self-compassion is positively related to helping self-efficacy.

- H2b. After a helping failure, self-compassion has a positive indirect effect on future helping through helping self-efficacy.

- H3b. The indirect positive effect of self-compassion on future helping through helping self-efficacy will be stronger when coworker blame attribution is low.


假设逻辑：

- 【因果】X 影响 M ；

- 【中介】X 通过 M 对 Y 产生影响；

- 【调节】W 可调节 X 对 M 的影响；

- 【被调节的中介】W 可调节 X 通过 M 对 Y 的间接效应。

---

## 线性回归

H2a：帮助失败后的自我同情会增加帮助的自我效能感。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151906000.png)

---


## 线性回归原理

.pull-left[

`\(y= ν+βx\)`

ν 是截距，β 是斜率。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312132115453.png)]

--
.pull-right[
`\(y_i=ν +βx_i+  ε_i\)`

ν 是截距，β 是斜率。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312132119332.png)
]

---


## 线性回归检验（SPSS按键版）

.pull-left[

- 【分析】-【回归】-【线性】

- 将【M】拖入因变量中 

- 将【X】拖入自变量中 

- 点击【确定】

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151156768.png)]

--
.pull-right[

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151157228.png)]


---



## 线性回归检验（SPSS语法版）

```sql
REGRESSION
  /MISSING LISTWISE
  /STATISTICS COEFF OUTS R ANOVA
  /CRITERIA=PIN(.05) POUT(.10)
  /NOORIGIN 
  /DEPENDENT guiltM
  /METHOD=ENTER SELFCOMP.
```

/DEPENDENT 后接因变量，可以放入多个。

/METHOD=ENTER 后接自变量，每一行即为进行一次回归。

当要进行多次回归时，可直接在其后新增 /METHOD=ENTER

.pull-left[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151857051.png)]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151856761.png)]

---

## 中介效应

H2b：帮助失败后的自我同情会增加帮助的自我效能感，从而促进未来的帮助行为。

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151903796.png)

---


## 中介效应原理

.pull-left[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151953012.png)]


.pull-right[ 
`\(M=aX+e_M\)`

`\(Y=c'X+bM+e_Y\)`]

--

`\(Y=(c'+ab)X+b e_M+e_Y\)`

显而易见，X 对 Y 的总影响其实是包括了两个部分，分别为 `\(c'+ab\)`。

- `\(c'\)` 被视为直接效应量，即 X 直接作用于 Y 的效应；
- `\(ab\)` 则被视为间接效应量，又是中介效应量，代表 X 通过 M 作用于 Y 的效应量。

所以要证明 X 通过 M 作用于 Y ，需要证明 `\(ab ≠ 0\)`  。

---


## 中介效应检验（ *β* ）
.pull-left[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151920697.png)]
.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151922621.png)]

---

## 中介效应检验（Indirect effect）

Bootstrapping Method

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152001743.png)

.footnote[From Zhou Kong, 2021, Wuhan]

---

## 中介效应检验（Indirect effect）


![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152002114.png)

.footnote[From Zhou Kong, 2021, Wuhan]

---

## 调节效应


同事的责备归因是否会影响帮助失败后的同情与愧疚之间的关系？

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312151924652.png)

---

## 调节效应原理

.pull-left[

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152009008.png)]

.pull-right[ 
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152019863.png)]

`\(Y=b_1X+b_2M+b_3XM+e_Y =(b_1+b_3M)X+b_2M+e_Y\)`

显而易见，X 对 Y 的总影响其实是包括了两个部分，分别为 `\(b_1+b_3M\)`。

- 当 `\(b_3＝0\)` 时，M 无论取什么值， X 对 Y 的影响都是 `\(b_1\)`，斜率不变，此时不存在调节效应；
- 当 `\(b_3≠0\)` 时，每当 M 取值增加 1 个单位， X 对 Y 的影响也会增加 `\(b_3\)` 个单位， X 对 Y 的影响会受 M 的取值变化，斜率改变，此时调节效应才会存在。

所以 `\(b_3\)` 就是调节效应量，能衡量调节效应的大小。存在调节效应需要 `\(b_3≠0\)`。

---

## 调节效应检验（ *β* ）  
.pull-left[ 
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152035977.png)

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152038692.png)]


.pull-right[![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152037820.png)]

---

## 调节效应检验（Simple slope）

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152048274.png)


详细介绍见：[http://www.jeremydawson.co.uk/slopes.htm](http://www.jeremydawson.co.uk/slopes.htm)

---

## 被调节的中介效应

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152318129.png)

---

## 第一阶段被调节的中介效应

.pull-left[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112354437.jpeg)]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112354458.png)]


`\(M= a_0 + a_1X + a_2W + a_3 XW + e_1\)`

`\(Y= b_0 + b_1X + b_2M + e_2\)`

`\(Y= [b_0 + ( a_0 +a_2W)b_2]+[b_1+(a_1 + a_3 W)b_2] X +  (e_1+b_2 e_2)\)`


由公式可得，间接效应量的大小取决于调节变量 *W* 的取值。


被调节的中介成立条件为间接效应量 `\((a_1 + a_3 W)b_2\)` 随着 *W* 的取值将有显著差异。

---

## 第二阶段被调节的中介效应

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112354445.jpeg)]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152342660.png)]


`\(M= a_0 + a_1X + e_1\)`

`\(Y= b_0 + b_1X + b_2M + b_3W + b_4 MW +  e_2\)`


`\(Y= (b_0 + a_0 b_2)+[b_1+a_1 (b_2+ b_4W)] X + (b_3+a_0b_4)W+ (b_2e_1+ e_2)\)`


由公式可得，间接效应量的大小取决于调节变量 *W* 的取值。


被调节的中介成立条件为间接效应量 `\(a_1 (b_2+ b_4W)\)` 随着 *W* 的取值将有显著差异。

---

## 两阶段被调节的中介效应

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112354471.jpeg)]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312152345293.jpg)]


`\(M= a_0 + b_1X + a_1W_1 + b_2 XW_1 + e_1\)`

`\(Y= a_2 + a_3W_1+a_4W_2+ b_3M + b_4MW_2+ b_5X +b_6XW_1+ e_2\)`

`\(Y= [intercept +a_1b_3W_1+a_0b_4W_2+a_1b_4W_1W_2+[b_5+b_6W_1]\)`
`\(+(b_1+b_2W_1)(b_3+b_4W_2)]X+error\)`


被调节的中介成立条件为间接效应量 `\((b_1+b_2W_1)(b_3+b_4W_2)\)` 随着两个 *W* 的取值将有显著差异。

---

## 被调节的中介效应原理汇总

第一阶段被调节的中介模型的间接效应值:

`\((a_1 + a_3 W_h)b_2-(a_1 + a_3 W_l)b_2\)`

第二阶段被调节的中介模型的间接效应值:

`\(a_1 (b_2+ b_4W_h)-a_1 (b_2+ b_4W_l)\)`

两阶段被调节的中介模型的间接效应值:

`\((b_1+b_2W_{1h})(b_3+b_4W_{2h})-(b_1+b_2W_{1l})(b_3+b_4W_{2l})\)` 

---

## 被调节的中介效应检验

- 第一阶段被调节的中介效应: `\((a_1 + a_3 W_h)b_2-(a_1 + a_3 W_l)b_2\)`

.left-column-64[
.code85.remark-code[
```Mplus
TITLE: mono-level first stage moderated mediation
DATA:FILE IS example 1.dat;
VARIABLE:NAMES ARE x w m y;
USEVARIABLES ARE x m w y xw;
DEFINE: 
*CENTER x w (GRANDMEAN);
*xw=x*w;! 先中心化，再进行交互，以避免共线性。
ANALYSIS:BOOTSTRAP=2000;
MODEL:
m on x (a1)
​    w
​    xw (a3);
y on m (b2)   
​    x w xw;
MODEL CONSTRAINT:
new (w0 ind_h ind_l ind_d);
*w0=0.8552; ! W的标准差。
ind_h=(a1+a3*w0)*b2;
ind_l=(a1-a3*w0)*b2;
*ind_d=ind_h-ind_l; ! ind_d为间接效应量。
OUTPUT: cinterval (bcbootstrap);
```]]

.right-column-64[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112354077.jpeg)]


---

## 被调节的中介效应检验

- 第二阶段被调节的中介效应: `\(a_1 (b_2+ b_4W_h)-a_1 (b_2+ b_4W_l)\)`

.code90.remark-code[
```Mplus
TITLE: mono-level second stage moderated mediation
DATA:FILE IS example 1.dat;
VARIABLE:NAMES ARE x w m y;
USEVARIABLES ARE x m w y mw;
DEFINE: 
*CENTER m w (GRANDMEAN);
*mw=m*w;
ANALYSIS:BOOTSTRAP=2000;
MODEL:
*m on x (a1)；
*y on m (b2)   
*​    mw (b4)   
*​    x w;
MODEL CONSTRAINT:
new (w0 ind_h ind_l ind_d);
w0=0.8552;! 这里的数值为W的标准差，需根据自己数据修改。
*ind_h=a1*(b2+b4*w0);
*ind_l=a1*(b2-b4*w0);
ind_d=ind_h-ind_l;! ind_d为间接效应量。
OUTPUT: cinterval (bcbootstrap);
```]

---

## 被调节的中介效应检验

 `\((b_1+b_2W_{1h})(b_3+b_4W_{2h})-(b_1+b_2W_{1l})(b_3+b_4W_{2l})\)` 

.code80.remark-code[
```Mplus
TITLE: mono-level two stage mome
DATA:FILE IS example 1.dat;
VARIABLE:NAMES ARE x w1 m w2 y;
USEVARIABLES ARE x m w1 w2 y xw1 mw2;
DEFINE:CENTER x m w1 w2(GRANDMEAN);
xw1=x*w1;
mw2=m*w2;
ANALYSIS:BOOTSTRAP=2000;
MODEL:
m on x (b1)
​    xw1(b2)
​     w1;
y on m (b3)   
​    mw2(b4)
​    x w1 xw1 w2;
MODEL CONSTRAINT:
new (w01 w02 ind_h ind_l ind_d);
w01=0.8552;
w02=0.8819;
ind_h=(b1+b2w1)*(b3+b4w2);
ind_l=(b1-b2w1)*(b3-b4w2);
ind_d=ind_h-ind_l;
OUTPUT: cinterval (bcbootstrap);
```]


---

## 被调节的中介效应检验

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312161250688.png)

---

## 第一类被中介的调节效应

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112358780.png)]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112358800.png)]


`\(M= a_0 + a_1X + a_2W + a_3 XW + e_1\)`

`\(Y= b_0 + b_1X + b_2M + b_3W+b_4XW+ e_2\)`


被中介的调节成立条件为间接效应量 `\(a_3×b_2\)` 显著。

---

##  被调节的中介 VS 被中介的调节

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112354458.png)

]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112358800.png)
]

即使上述两个模型画出来的模型图完全一样，但其内在的逻辑有所差异。

大家需要根据研究故事的逻辑进行相应检验：

- 被调节的中介模型： `\((a_1 + a_3 W_h)b_2-(a_1 + a_3 W_l)b_2\)`

- 被中介的调节模型： `\(a_3×b_2\)`

.footnote[经验之谈：目前还是被调节的中介模型使用地更为广泛。]

---

## 第二类被中介的调节效应

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112358769.png)]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312161308867.png)]


`\(M= a_0 + a_1X + a_2W+ e_1\)`

`\(Y= b_0 + b_1X + b_2M + b_3W + b_4XW+b_5 MW +  e_2\)`


被中介的调节成立条件为间接效应量 `\(a_2×b_5\)` 显著。


---

## 被中介的调节效应检验

- 第一类被中介的调节效应:  `\(a_3×b_2\)`

```Mplus
TITLE: Type I mediated moderation
DATA:FILE IS example 1.dat;
VARIABLE:NAMES ARE x w m y;
USEVARIABLES ARE x m w y xw;
DEFINE: 
CENTER x m w (GRANDMEAN);
xw=x*w;
ANALYSIS:BOOTSTRAP=2000;
MODEL:
m on xw(a3)
​    x w;
y on m(b2)
​    x w xw;
MODEL CONSTRAINT:
NEW (ind) ;
*ind=a3*b2;
OUTPUT: cinterval (bcbootstrap);
```

---

## 被中介的调节效应检验

- 第二类被中介的调节效应:  `\(a_2×b_5\)`


```Mplus
TITLE: Type I mediated moderation
DATA:FILE IS example 1.dat;
VARIABLE:NAMES ARE x w m y;
USEVARIABLES ARE x m w y xw xm;
DEFINE: 
CENTER x m w (GRANDMEAN);
xw = x*w;
xm = x*m;
ANALYSIS: BOOTSTRAP=2000;
MODEL:
m ON w(a2)
​      x;
y ON xm(b5)
​     m x w xw;
MODEL CONSTRAINT:
NEW (ind) ;
*ind = a2 * b5;
OUTPUT: cinterval (bcbootstrap);
```

---
## 被中介的调节效应检验

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112358764.jpeg)

---

## U型模型

当自变量跟调节变量相同时可以当做曲线的中介，即正U型非线性中介

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120007210.png)]

.pull-right[


`\(M=a_0+a_1x+a_2x^2+e_M\)`

`\(Y=b_0+b_1M+b_2x+b_3x^2+e_Y\)`]

--

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120007059.png)

对各自的斜率求导：

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120007088.png)

---

## U型模型检验

.pull-left[
```Mplus
TITLE: U example;
DATA: file is 1.dat;
VARIABLE: names are x y m 
xsq;! xsq为x的平方
usevariables are x y m xsq;
ANALYSIS:
bootstrap = 20000;
MODEL:
m on x (a1)
​   xsq (a2);
y on x (c1)
​   xsq (c2)
m (b1);
[m] (a0);
```]

.pull-right[
```Mplus
MODEL CONSTRAINT:
new (x1 x2 x3 predm1 predm2 
predm3 theta1 theta2 
theta3);!三个点才能画出曲线
x1 = 3.9460;！Mean-1SD
x2 = 5.2275;！Mean
x3 = 6.5090;！Mean+1SD
predm1 = a0+a1*x1+a2*x1*x1; 
predm2 = a0+a1*x2+a2*x2*x2; 
predm3 = a0+a1*x3+a2*x3*x3; 
theta1 = (a1+2*a2*x1)*b;
theta2 = (a1+2*a2*x2)*b;
theta3 = (a1+2*a2*x3)*b;
OUTPUT:
cinterval (bcbootstrap);
```]

---
class: inverse, middle, center

# 单层数据分析 in R

 

---

## Step 1：导入原始数据

首先，我自己的习惯是将数据文件和Rproject放在同一个文件夹，这样方便后续调用。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322545.png)

其次，要提醒大家的是，如果第一次使用R包，需要先安装它（系统自带的除外，不知道是不是自带的，你就都安装试试）。

安装R包的语句示例：

```R
install.packages("openxlsx")
```

后续我就不再强调这个问题了。

最后，数据导入的方式千千万万种，我这里仅介绍几种，掌握一种就行。

---


## Step 1：导入原始数据（xlsx）

```R
library(openxlsx)
data &lt;- read.xlsx("R.xlsx", )
```

所用R包：openxlsx。

- 第一行：调用openxlsx包。
- 第二行：将【R.xlsx】读取，并命名为【data】。

---

## Step 1：导入原始数据（csv）

如果使用csv格式，也可以用readr包。

```R
library(readr)
data &lt;- read_csv("data/Study 1 Data.csv")
```

所用R包：readr。

- 第一行：调用readr包。
- 第二行：将【data/Study 1 Data.csv】读取，并命名为【data】。

运行后可以在Environment里看到data。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322539.png)

---


## Step 1：导入原始数据（点击版）

如果不想写语法，大家还可以在RStudio里找到文件点击Import Dataset。

.pull-left[
![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322531.png)

]

.pull-right[

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322291.png)]

不过这样导入的数据名是原始的，所以我们可以在import options里进行修改。

---

## Step 2：信度

```r
library(dplyr)
alphaX &lt;- data %&gt;% select(X1:X4)
library(psych)
alpha(alphaX) 
```

所用R包：dplyr、psych。

- 第一行：调用dplyr包。

- 第二行：在【data】中，选择【X1至X4】这几列，其将形成新的数据文件，并命名为【alphaX】。
- 第三行：调用psych包。

- 第四行：计算【alphaX】的信度。

---

## Step 2：信度


不过，上面的输出结果很长，并且每次都会新生成一个数据文件。

```r
data %&gt;% dplyr::select(X1:X4) %&gt;% psych::alpha() %&gt;% summary
data %&gt;% dplyr::select(M1:M3) %&gt;% psych::alpha() %&gt;% summary
data %&gt;% dplyr::select(Y1:Y5) %&gt;% psych::alpha() %&gt;% summary
data %&gt;% dplyr::select(W1:W3) %&gt;% psych::alpha() %&gt;% summary
```

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322523.png)

---

## Step 2：效度

```r
library(lavaan) 
model4 &lt;- 'CFAX =~ X1 + X2 + X3 + X4
CFAM =~ M1 + M2 + M3
CFAY =~ Y1 + Y2 + Y3 + Y4 + Y5
CFAW =~ W1 + W2 + W3'
fit4 &lt;-cfa(model4, data=data)
summary(fit4, fit.measures=TRUE)
```

所用R包：lavaan。

- 第一行：调用lavaan包。

- 第二行：构建一个CFA的model，并命名为【model4】。

- 第三行：利用【data】中的数据，计算【model4】的拟合指数，并将结果命名为【fit4】。

- 第四行：汇报【fit4】的各指标。

---

## Step 2：效度

.pull-left[![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322573.png)]


后续大家还要按需来汇报替代模型的CFA结果。

```r
model31 &lt;- 'CFAX =~ X1 + X2 + X3 + X4
CFAM =~ M1 + M2 + M3 + Y1 + Y2 + Y3 + Y4 + Y5
CFAW =~ W1 + W2 + W3'
fit31 &lt;-cfa(model31, data=data)
summary(fit31, fit.measures=TRUE)

model32 &lt;- 'CFAX =~X1 + X2 + X3 + X4 + W1 + W2 + W3
CFAM =~ M1 + M2 + M3
CFAY =~ Y1 + Y2 + Y3 + Y4 + Y5'
fit32 &lt;-cfa(model32, data=data)
summary(fit32, fit.measures=TRUE)
```

---

## Step 2：均值、标准差

确定信效度都通过检验后，我们再来进行描述性分析和假设检验。

```r
subset &lt;- data %&gt;% select(X:W)
describe(subset)
```

所用R包：dplyr、psych。

- 第一行：在【data】中，选择【X至W】这几列，其将形成新的数据文件，并命名为【subset】。

- 第二行：汇报【subset】的描述性信息。


![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322605.png)

这里也可以一行到位，不过【subset】后续在计算相关时也会用到，所以我们还是不简化了。



---

## Step 2：相关系数

```r
correlation&lt;-corr.test(x=subset)
print(x = correlation, short = FALSE, digits=3)
```

所用R包：psych。

- 第一行：计算【subset】的相关矩阵，将其结果命名为【correlation】。

- 第二行：汇报【subset】的描述性信息。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322490.png)

---

## Step 2：相关系数

为了便于汇报，我们也可以直接输出对应指标的下三角形。

```r
lowerMat(correlation$r, digits=3)
lowerMat(correlation$p, digits=3)
```

- digits=3，即为保留3位小数。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322979.png)

---
## Step 3：变量标准化


```r
data$ZX=scale(data$X,center = TRUE, scale = TRUE)
data$ZW=scale(data$W,center = TRUE, scale = TRUE)
data$int=data$ZX * data$ZW
```

- 第一行：将【data】中的【X】标准化，并将其结果储存为【data】中的【ZX】。
- 第二行：将【data】中的【W】标准化，并将其结果储存为【data】中的【ZW】。
- 第三行：将【data】中的【ZX】和【ZW】相乘，并将其结果储存为【data】中的【int】。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322242.png)

---

## Step 3：路径分析

```yaml
mome &lt;-'M~ a0* X + W +a1*int
Y ~ b*M + X + W +int
    slope_h: = a0+a1*(2.05)
    slope_l: = a0-a1*(2.05)
    ind_h: = slope_h*b
    ind_l: = slope_l*b
    ind_d: =ind_h-ind_l'
```

所用R包：lavaan。

- 第一行：根据假设，构建一个结构方程模型的model，并命名为【mome】。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322500.png)


---

## Step 3：计算bootstrap

```r
set.seed(1)
```

如果不写这一句，每次Bootstrap的结果都可能会不同，所以为了结果可重复性，我个人还是建议加上这句。不过括号中的数字是【1】还是【123】，这就无所谓了。


```r
mome.fit&lt;-sem(mome,data=data,se="bootstrap", bootstrap=5000)
```

利用【data】中的数据，计算【mode】，进行Bootstrap【5000】次的结果，并命名为【mome.fit】。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322714.png)

---

## Step 3：输出结果

```r
summary(mome.fit,fit.measures="TRUE",rsquare="TRUE")
```

输出【mome.fit】的结果。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322115.png)

直到这一步，才会在输出区域有显示。

---

## Step 3：置信区间

```r
parameterestimates(mome.fit,boot.ci.type="perc",standardize=TRUE)
```

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112322998.png)

在涉及变量较多时，有时候结果会显示不全。我们在任意位置运行以下语句即可。

```r
options(max.print=1000000)
```

---


## 整体语法汇总

.code85.remark-code[
```r
## Step 1：导入原始数据
library(openxlsx)
data &lt;- read.xlsx("R.xlsx", )


## Step 2：信效度+描述性统计
### 信度
library(dplyr)
library(psych)
data %&gt;% dplyr::select(X1:X4) %&gt;% psych::alpha() %&gt;% summary
data %&gt;% dplyr::select(M1:M3) %&gt;% psych::alpha() %&gt;% summary
data %&gt;% dplyr::select(Y1:Y5) %&gt;% psych::alpha() %&gt;% summary
data %&gt;% dplyr::select(W1:W3) %&gt;% psych::alpha() %&gt;% summary

### CFA
library(lavaan) 
model4 &lt;- 'CFAX =~ X1 + X2 + X3 + X4
CFAM =~ M1 + M2 + M3
CFAY =~ Y1 + Y2 + Y3 + Y4 + Y5
CFAW =~ W1 + W2 + W3'
fit4 &lt;-cfa(model4, data=data)
summary(fit4, fit.measures=TRUE)
```]

---


## 整体语法汇总

.code85.remark-code[
```r
model31 &lt;- 'CFAX =~ X1 + X2 + X3 + X4
CFAM =~ M1 + M2 + M3 + Y1 + Y2 + Y3 + Y4 + Y5
CFAW =~ W1 + W2 + W3'
fit31 &lt;-cfa(model31, data=data)
summary(fit31, fit.measures=TRUE)

model32 &lt;- 'CFAX =~X1 + X2 + X3 + X4 + W1 + W2 + W3
CFAM =~ M1 + M2 + M3
CFAY =~ Y1 + Y2 + Y3 + Y4 + Y5'
fit32 &lt;-cfa(model32, data=data)
summary(fit32, fit.measures=TRUE)

## 均值、标准差
options(max.print=1000000)
subset &lt;- data %&gt;% select(X:W)
describe(subset)

## 相关系数
correlation&lt;-corr.test(x=subset)
lowerMat(correlation$r, digits=3)
lowerMat(correlation$p, digits=3)

# Step 3：路径分析
## 中心化
data$ZX=scale(data$X,center = TRUE, scale = TRUE)
data$ZW=scale(data$W,center = TRUE, scale = TRUE)
data$int=data$ZX * data$ZW
```]

---


## 整体语法汇总


.code85.remark-code[
```r
## 路径分析
library(lavaan) 
mome &lt;-'M~ a0* X + W +a1*int
Y ~ b*M + X + W +int
    slope_h: = a0+a1*(2.05)
    slope_l: = a0-a1*(2.05)
    ind_h: = slope_h*b
    ind_l: = slope_l*b
    ind_d: =ind_h-ind_l'

### 自定义重复抽样种子
set.seed(1)

### 计算bootstrap
mome.fit&lt;-sem(mome,data=data,se="bootstrap", bootstrap=5000)

### 输出结果
summary(mome.fit,fit.measures="TRUE",rsquare="TRUE")

### 置信区间
parameterestimates(mome.fit,boot.ci.type="perc",standardize=TRUE)
```]



---
class: inverse, middle, center

# 多层线性模型原理

 
---

## 回归分析

#### 数据公式

`\(Y_{i}=β_{0}+β_{1}X_{i}+r_{i}\)`

#### 基本假设

- 线性（Linearity）

- 残差正态分布（ normally distributed）

- 残差方差齐性（homoskedastic）

- 残差或观测个体之间相互独立（independent）

---

## 多水平数据

#### 概念

在单位上具有嵌套的关系的观测数据。

#### 特点

- 同一单位内的观测，具有更大的相似性。

- 即残差和观测个体之间.red[不会相互独立]。


#### 举例

- 学生嵌套于班级，班级嵌套于学校；

- 员工嵌套于团队，团队嵌套于组织；

- 个体不同时点重复测量嵌套于个体；

- ……


---
 
## 传统回归 VS 多水平数据

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Paper/202312182138880.png)

---

## 固定斜率，随机截距

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162239252.png)

---

## 随机斜率，固定截距

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162241369.png)

---

## 随机斜率，随机截距

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162241471.png)

---

## 跨层调节

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120001317.png)


- `\(γ_{00}\)` ：截距的均值；

- `\(γ_{10}\)`：x对y斜率的均值；

- `\(γ_{01}\)`：w对y的影响；

- `\(γ_{11}\)`：w与x对y的跨层交互效应；]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162254462.png)


- `\(r_{ij}\)`：残差；

- `\(μ_{0j}\)`：随机截距；

- `\(μ_{1j}\)`：随机斜率。]

---

## 无条件模型：检验ICC

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162338190.png)

---

## 无条件模型：检验ICC


.pull-left[
```Mplus
TITLE: example
DATA:
FILE = multilevel_SE.dat;
VARIABLE: 
NAMES = cntid schid ssid 
gender ses seff scon score 
weight sescnt sessch scosch;

USEV = schid gender ses 
scon score scosch;

CLUSTER = schid;
BETWEEN = scosch;
MISSING ARE ALL (9999);

ANALYSIS: TYPE = TWOLEVEL;
MODEL:

```]
.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162331216.jpg)]

---

## 检验主效应

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162339935.png" width="80%" style="display: block; margin: auto;" /&gt;

---


## 检验主效应

.pull-left[
.code90.remark-code[
```Mplus
TITLE: example
DATA:
FILE = multilevel_SE.dat;
VARIABLE: 
NAMES = cntid schid ssid 
gender ses seff scon score 
weight sescnt sessch scosch;
USEV = schid gender ses 
scon score scosch;
Define:
CENTER ses score (GROUPMEAN);
*WITHIN= gender ses score;
BETWEEN = scosch;
CLUSTER = schid;
MISSING ARE ALL (9999);
ANALYSIS: TYPE = TWOLEVEL;
MODEL:
%WITHIN% !在组内水平计算
scon ON score gender ses;
%BETWEEN% !在组间水平计算
scon ON scosch;
```]]


.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162337841.jpg)

由结果可得：P&lt;0.05，四个对个人自我概念的回归均显著。.red[γ10表示个人成绩对个人自我概念的主效应；γ01表示学校平均成绩对个人自我概念的主效应。]]


---

## 检验学校差异的直接效应

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162341098.png" width="90%" style="display: block; margin: auto;" /&gt;

---

## 检验学校间是否存在斜率差异


.pull-left[
.code70.remark-code[
```Mplus
TITLE: example
DATA:
FILE = multilevel_SE.dat;
VARIABLE: 
NAMES = cntid schid ssid 
gender ses seff scon score 
weight sescnt sessch scosch;
USEV = schid gender ses 
scon score scosch;
Define:
CENTER ses score (GROUPMEAN);
CLUSTER = schid;
WITHIN= gender ses score;
BETWEEN = scosch;
MISSING ARE ALL (9999);
ANALYSIS: 
TYPE = TWOLEVEL RANDOM;
!采用两水平的随机模型，允许斜率不固定。
MODEL:
%WITHIN%
scon ON ses gender;
s | scon ON score; 
!将scon关于score的斜率定义为s
%BETWEEN%
scon ON scosch;
scon with s;
!scon和s相关，优化拟合
```
]]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162345689.jpg)

S的残差( `\(u_{1j}\)` )显著表示.red[斜率随机，不同学校的斜率不同]。]

---
## 检验学校差异和个人成绩的交互作用

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162349957.png" width="90%" style="display: block; margin: auto;" /&gt;

---

## 检验学校差异和个人成绩的交互作用

.code80.remark-code[
.pull-left[

```Mplus
TITLE: example
DATA:
FILE = multilevel_SE.dat;
VARIABLE: 
NAMES = cntid schid ssid 
gender ses seff scon score 
weight sescnt sessch scosch;
USEV = schid gender ses 
scon score scosch;
Define:
CENTER ses score (GROUPMEAN);
CLUSTER = schid;
WITHIN= gender ses score;
BETWEEN = scosch;
MISSING ARE ALL (9999);
ANALYSIS: TYPE = TWOLEVEL RANDOM;
MODEL:
%WITHIN%
scon ON ses gender;
s | scon ON score; 
%BETWEEN%
scon ON scosch;
*s on scosch;
scon with s;
```]]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312162351077.jpg)

`\(r_{11}\)`显著表示.red[表示个人成绩与学校平均成绩对个人自我概念存在跨层交互效应。]]

---

## 一些跨层模型示例

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120001317.png)]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004614.png)]

                                                        
.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120001292.png)]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004564.png)]

---
## 特殊的跨层调节


在数理统计上，.red[w是无法影响y的，它能影响的只有y的均值]（即第二水平的y）。

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120001950.jpeg" width="60%" style="display: block; margin: auto;" /&gt;

从上图可以看出相同的w会对应不同的y，这是因为y是第一水平的变量，而w是第二水平的变量，所以w实际上对y的影响是通过影响各组y的均值而实现的。

---

## 特殊的跨层调节

.pull-left[
所以模型应该转化为下图中这样。

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120001967.png)]

.pull-right[
![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312170018097.png)]

从上图可以发现，x在组内是会发生变化的，但是w和y在每组中都是固定的，那么x怎么调节w和y的关系？

所以，.red[**HLM无法接受从下至上的调节**]。

这个模型需要进行调整。但是坦白说，目前并没有很完善的调整方式，已有的几种方法各有各的不足。如果可以，尽量避免这种模型比较好。

---

## 跨层中介

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004614.png)]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004564.png)]

两种模型的处理方式在本质上没有差别，都是把level1的变量提升到level2的层次，最后变成2-2-2模型。

---

## 跨层中介
.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004614.png)]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004590.png)]

.pull-left[X→Y：

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004544.png)]

.pull-right[
X→M：

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004569.png)]


---
## 跨层中介

X→M→Y：

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120004581.jpeg" width="45%" style="display: block; margin: auto;" /&gt;


**成立条件**

将变量上提至同一水平后，其实就是简单的中介。此时中介效应成立条件和普通中介也没有差异，小可爱们类比就可以了。

**补充说明**

- 第一，公式8中的中介变量M表示为个体得分减去小组均值，这是由于小组均值部分已经被上提至水平2了，所以M需要将这个部分剥离，不然将会重复计算。

- 第二，虽然中介效应的成立取决于level2中的各系数，但是level1部分仍然应该被纳入控制变量，而不能直接不予考虑。


---

## 跨层中介

.code90.remark-code[
```Mplus
TITLE: 2-1-1 mediation (MSEM)
DATA: FILE IS mydata.dat;
VARIABLE: NAMES ARE group x m y;
USEVARIABLES ARE group x m y;
CLUSTER IS group; 
BETWEEN IS x; !没有within层的外甥变量，所以没定义
ANALYSIS: TYPE IS TWOLEVEL;
MODEL:
%WITHIN%
m y; ! 估计x、m、y在level1的方差
y ON m;
%BETWEEN% 
x m y; ! 估计x、m、y在level2的方差
m ON x(a); 
y ON m(b); 
y ON x;
MODEL CONSTRAINT:
NEW(indb); 
indb=a*b; 
OUTPUT: TECH1 TECH3 CINTERVAL; 
```
]

---

## 跨层次的被调节的中介

.pull-left[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120005379.png)
]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120005419.jpeg)

![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120005433.png)]

---
## 跨层次的被调节的中介

**成立条件**

回顾单层的第一阶段的被调节的中介模型，它的成立条件是 `\((a_1 + a_3 W)b_2\)` 随着 *W* 的取值将有显著差异。。

那么我们类比一下，b2的部分其实是没有变化的，所以b2还是b2，那前面的 `\((a_1 + a_3 W)\)` 在这个模型里变成了什么呢？

`\((a_1 + a_3 W)\)` 其实代表的是x对m斜率的影响

类比这里 `\((γ_{10}+γ_{11}W_j)\)` 代表的才是斜率，所以本模型成立条件为 `\((γ_{10}+γ_{11}W_j)b_2\)` 随着W的取值将有显著差异。

**补充说明**

- 第一，为什么模型中额外画出了level2的 `\(y_{.j}\)` 因为总⽅方差既有组间又有组内，然而我们只研究的是组内部分。但是涉及跨层时，软件默认会拆开因变量。

- 第二，最好加上变量间的相关关系。虽然加相关会降低主效应，但是可以提⾼高模型拟合度。

---

## 跨层次的被调节的中介

.pull-left[
```Mplus
TITLE: A two-level first-stage MoMe;
DATA; FILE IS example.txt;
VARIABLE: 
NAMES ARE x m w y cluster;
USE VARIABLES ARE x m w y;
CLUSTER = cluster;
WITHIN = x;
BETWEEN = w;
Define:
CENTER w (GRANDMEAN);
CENTER x (GROUPMEAN);
ANALYSIS:TYPE=TWOLEVEL RANDOM;
MODEL:
%WITHIN%
S | m on x;
y on m (b2)
x;
```]
.pull-right[
```Mplus
% BETWEEN%
S on w (a1) ;! γ11
[ S ] ( a0 ) ;! γ10
m on w;
m with S;
y with m;
y with S;
y with w;! 相关
MODEL CONSTRAINT:
new (w0 ind_h ind_l ind_d);
ind_h=(a0+a1*w0)*b2;
ind_l=(a0-a1*w0)*b2;
ind_d=ind_h-ind_l; ! 
OUTPUT:
SAMPSTAT;
CINTERVAL;
```]

---

## 跨层次的被中介的调节

.pull-left[![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120006172.png)
]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120006190.png)]

**成立条件**

有学者认为成立条件应该是 `\(a×b_b\)` ，因为他们认为第二水平的效果不能与第一水平的影响相乘，所有的中介效果应该都发生在第二水平。

但是也有其他学者认为成立条件是 `\(a×b_w\)`或者 `\(a×(b_b+b_w)\)`，所以这里乘以b的哪种形式，取决于研究者的基础假定。


---

## 跨层次的被中介的调节

.code85.remark-code[
```Mplus
TITLE: A two-level Type I MeMo model,
DATA: FILE IS example.txt;
DEFINE:
CENTER w x (GRANDMEAN);
xw = x * w ;
VARIABLE: NAMES ARE x m w y cluster;
USEVAR1ABLES ARE x m w y xw;
CLUSTER = cluster;
BETWEEN = x w xw;
ANALYSIS: TYPE = TWOLEVEL;
MODEL: 
% WITHIN %
y on m (bw)
% BETWEEN%
m on x w
xw (a) ;
y on m (bb)
x w xw;
MODEL CONSTRAINT;
NEW (ind) ;
ind = a * bb;
OUTPUT:
SAMPSTAT;
CINTERVAL;
```]

---

## 跨层次的被中介的调节

.pull-left[![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120006185.png)
]

.pull-right[
![图片](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309120006197.jpeg)]

 **成立条件**

模型成立条件与单层时相同，也是*ab*显著。

---

## 跨层次的被中介的调节


.code80.remark-code[
```Mplus
TITLE : A two-level Type II MeMo;
DATA: FILE IS example.txt;
VARIABLE: NAMES ARE x m w y cluster;
USEVARIABLES ARE x m w y;
CLUSTER = cluster;
WITHIN = x;
BETWEEN = w m;
Define:
CENTER w m (GRANDMEAN);
CENTER x (GROUPMEAN);
ANALYSIS:
TYPE =TWOLEVEL RANDOM;
% WITHIN %
S | y on x;
% BETWEEN%
m on w (a) ;
S on m (b)
w;
y on m w;
y with S
MODEL CONSTRAINT;
NEW (ind) ;
ind = a * b;
OUTPUT;
SAMPSTAT;
CINTERVAL;
```]

---
class: inverse, middle, center

# 跨层模型的数据分析全流程

---
## 跨层数据的有效性

拿到嵌套数据后，我们首先要进行必要性分析，证明嵌套的数据它有做跨层的必要。该步骤的常见指标为：ICC(1)、ICC(2)、Rwg，多以文字形式汇报。

![img](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112342332.png)

---
## 跨层数据的有效性

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312170859013.png@f_auto" width="70%" style="display: block; margin: auto;" /&gt;

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312170900923.png@f_auto" width="65%" style="display: block; margin: auto;" /&gt;

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312170900548.png@f_auto" width="50%" style="display: block; margin: auto;" /&gt;

---

## 计算ICC

①【分析】-【比较均值】-【单因素ANOVA】；

②将【跨层变量】从左侧拖入右侧因变量中➔将【分组变量】拖入【因子】中➔点击【确定】；

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112342262.png" width="50%" style="display: block; margin: auto;" /&gt;

③此时，可得到如下结果：

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112342160.png" width="50%" style="display: block; margin: auto;" /&gt;

---
## 计算ICC


④将结果复制至Excel模板➔输入【总人数/团队数】

此时，Excel会自动得出结果，如下图：

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112342945.png" width="50%" style="display: block; margin: auto;" /&gt;

---
## 计算Rwg
①打开SPSS的数据文件；

②【文件】-【新建】-【语法】；

③输入如下语句➔点击运行；

```SPSS
AGGREGATE
/outfile='C:\Users\tie\Desktop\rwg.sav' 
/break=TID
/sdx1 sdx2 sdx3 = SD(x1 x2 x3).
execute.
```
- 第二行，运行结果储存为指定位置的rwg.sav文件。需替换为自己想要输出的文件名及位置；

- 第三行，替换为自己的分组变量；

- 第四行，替换为自己的跨层题项。需注意的是：量表有多少个题项都要计算。

---
## 计算Rwg
④输入如下语句➔点击运行；

```SPSS
GET file='C:\Users\tie\Desktop\rwg.sav'.
COMPUTE varx1 = sdx1 * sdx1.
COMPUTE varx2 = sdx2 * sdx2.
COMPUTE varx3 = sdx3 * sdx3.
compute mvar=MEAN(varx1,varx2,varx3).
compute nvar=3.
compute rwg=nvar×(1-(mvar/2))/(nvar×(1-(mvar/2))+mvar/2).
execute.
```

其中，nvar代表题项数，最后一行的2则是根据量表等级决定的。

公式为(X × X - 1)/12 。

- 5点量表该值为2；

- 6点量表该值为2.92；

- 7点量表该值为4；

---
## 计算Rwg

此时，文件中会新生成几个变量，如图：

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112342286.png" width="70%" style="display: block; margin: auto;" /&gt;

⑥计算Rwg的中位数与平均值；

这里注意，原始Rwg小于0时取0，大于1时取1。

 **【判断标准】**

Rwg＞0.7。

---
## 计算Multilevel CFA

```Mplus
TITLE ：Multilevel CFA； 
DATA: FILE IS 1.dat;
VARIABLE: NAMES ARE id x1-x6;
USEVARIABLES = id x1-x6; 
CLUSTER = id;
ANALYSIS: TYPE = TWOLEVEL ; 
MODEL:
%Within% 
wx by x1 x2 x3 x4 x5 x6; 
%Between% 
bx by x1 x2 x3 x4 x5 x6; 
Output: 
Standardized CINTERVAL TECH4;
```

.footnote[跨层相关分析不用额外写语句，就在跨层验证性因子分析的时候，在output中补充输出：TECH4即可]

---

## 假设检验


.pull-left[
```Mplus
TITLE: A two-level first-stage MoMe;
DATA; FILE IS example.txt;
VARIABLE: 
NAMES ARE x m w y cluster;
USE VARIABLES ARE x m w y;
CLUSTER = cluster;
WITHIN = x;
BETWEEN = w;
Define:
CENTER w (GRANDMEAN);
CENTER x (GROUPMEAN);
ANALYSIS:TYPE=TWOLEVEL RANDOM;
MODEL:
%WITHIN%
S | m on x;
y on m (b2)
x;
```]
.pull-right[
```Mplus
% BETWEEN%
S on w (a1) ;! γ11
[ S ] ( a0 ) ;! γ10
m on w;
m with S;
y with m;
y with S;
y with w;! 相关
MODEL CONSTRAINT:
new (w0 ind_h ind_l ind_d);
ind_h=(a0+a1*w0)*b2;
ind_l=(a0-a1*w0)*b2;
ind_d=ind_h-ind_l; ! 
OUTPUT:
SAMPSTAT;
CINTERVAL;
tech1 tech3;
```]

---
## Monte Caro in R
上述都没有进行bootstrap检验。因为跨层数据是无法在mplus中进行这一步的，所以我们还需要借助R来补充分析。

网址：http://quantpsy.org/medmc/medmc.htm

1-1-1模型：http://quantpsy.org/medmc/medmc111.htm

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202309112342561.png" width="50%" style="display: block; margin: auto;" /&gt;


以上的数据都可以在mplus的TECH3中得到。

---
## 社会关系模型简介

从社会关系设计中收集的数据通常被称为定向二元数据(Directed Dyadic Data，DDD)。在DDD数据集中，衡量单位是从一个人（例如，行动者或感知者）指向另一个人（即伙伴或目标）的评价或行为。组织研究人员通常使用社会关系模型（SRM；Kenny &amp; La Voie, 1984）分析DDD。SRM是一个统计模型，它认为每个定向二元数据的测量是群体、行动者、伙伴和关系这四个成分的总和。

---
## 社会关系模型原理

![](https://tie-1315290370.cos.ap-beijing.myqcloud.com/Training/202312171345952.png)
---
## SRM可解决的研究问题

通过SRM可以有效解答关于关系现象的几种类型的问题。

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257105.png" width="70%" style="display: block; margin: auto;" /&gt;

---
## Question of variance

**分析因素**：方差，具体可分为群体、行动者、伙伴、关系的四种方差。

**核心逻辑**：SRM将DDD分解为四个主要的方差。每个方差的比例代表相应特征组件的相对重要性。

**研究问题**：一名员工对某位同事的看法或行为在多大程度上可以归因于群体、行动者、伙伴或关系的特点？

**具体示例**：在一项关于信任的研究中，Jones和Shah（2016）研究了信任的主要影响因素来源（信任者、受信任者或二元关系）以及随着时间的推移它如何变化。

---
## Question of reciprocity 

**分析因素**：协方差，具体可分为个体层的广义互惠和关系层的双向互惠。

**核心逻辑**：SRM在个人层面和关系层面上形成了两种形式的互惠。在个人层面上，&lt;u&gt;广义互惠反映了行动者对伙伴的评价与伙伴对同一行动者的评价之间的一致程度&lt;/u&gt;。这为SRM中的行动者和伙伴组件之间提供了相关性。在关系层面上，&lt;u&gt;双向互惠反映了特定行动者对给定伙伴的评价与该伙伴对该行动者的评价之间的程度&lt;/u&gt;。

**研究问题**：二元互动在多大程度上是相互的？

**具体示例**：Joshi和Knight（2015）在检验假设前，研究了顺从、对任务贡献的感知、以及社会亲和力中的互惠程度。

---
## Question of explanation

**分析因素**：协变量估计，即回归系数。

**核心逻辑**：SRM允许包含DDD的预测性或解释性变量。

**研究问题**：预测因素与关系结果之间有何关联？

**具体示例**：Joshi(2014)研究了科学和工程团队中的男性和女性如何通过考虑性别和教育水平等二元成员的属性来评估他们的同事专业知识。

---
## SRM_R 的优势

虽然以往研究已经开发了多种统计检验方法进行SRM的数据分析，包括ANOVA法、最大似然法和贝叶斯法。但是每种统计方法都有自己的术语和假设。因此，在进行社会关系分析时仍然存在重大的入门障碍和陡峭的学习曲线。

[SRM_R](https://davidakenny.shinyapps.io/SRM_R/) 的优点在于：

- SRM_R可以免费在线访问，无需统计软件，也无需对统计技术有详细的背景知识即可使用其所有功能。

- SRM_R自动完成了许多复杂的二元数据集设置，包括数据操作和组织步骤，这对于那些编程技能有限的人来说可能是一种障碍。

- SRM_R提供了总结和解释统计分析的文本。

- SRM_R生成一个包含所有必要转换变量和R代码的新数据集，以便在SRM_R环境之外运行附加分析。

因此，研究人员无需成为方法专家即可使用SRM_R应用程序，他们可以专注于开发关于二元过程的理论的复杂挑战，而软件会处理复杂的数据分析例程。

---
## SRM的具体案例

**样本**：作者收集了中国一家大型国有电信公司项目组成员关于寻求建议行为的DDD。样本包含228名个体，分布在47个由四到五名成员组成的团队中，总共产生了884个直接的二元数据。

**测量**：

- T1：每个成员汇报自己的性别与主动性人格；
- T2：每个成员逐个评价向组内其他成员寻求建议的程度。


**具体问题**：

- 关于方差：影响寻求建议行为的因素来源于群体、个体（行动者和伙伴）还是关系？
- 广义互惠：在多大程度上，寻求建议频繁的人会吸引他人对其进行高水平的建议寻求？
- 双向互惠：团队成员是否相互给予相同或相反水平的寻求建议行为？
- 关于解释：团队成员之间的寻求建议行为是否取决于性别和主动性人格两个特征？


---

## SRM的具体案例

.pull-left[

![DDD数据](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257206.png)

- GID = 团队识别符号

- AID = 行动者识别符号

- PID = 伙伴识别符号

- Y = 行动者从伙伴寻求建议的程度
]

.pull-right[
- GX1 = 小组中女性成员的百分比

- GX2 = 小组成员主动性人格的平均水平

- AX1 = 行动者的性别

- AX2 = 行动者的主动性人格

- PX1 = 伙伴的性别

- PX2 = 伙伴的主动性人格

- RX1 = 同性别与异性别（行动者性别 × 伙伴性别）

- RX2 = 行动者和伙伴主动性人格的相似度（|行动者主动性人格 - 伙伴主动性人格|）]

---
## 步骤1：进入SRM_R网站

[https://davidakenny.shinyapps.io/SRM_R/](https://davidakenny.shinyapps.io/SRM_R/)

![初始界面](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257950.png)


---
## 步骤2：上传/选择数据

我这里就使用网站中的原始数据了，这也是文章中的示例数据。

![选择示例数据](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257859.png)

---
## 步骤3：识别变量

- 点击【Variables, Design, &amp; Terms】

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257972.png" width="70%" style="display: block; margin: auto;" /&gt;

- 用户必须在数据集中找到表示群体、行动者和伙伴的标识变量以及结果变量。在示例中，可从变量名列表中选择“GID”、“AID”、“PID”和“Y”。文本和表格的结果也可以命名，我们可将结果重命名为“Advice Seeking”。


---
## 步骤3：识别变量

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257635.png" width="40%" style="display: block; margin: auto;" /&gt;

默认情况下，SRM_R假定数据是可互换的，即所有被试既可以是行动者，也可以是伙伴。因此如果需要非互换半区组设计，用户应取消选中【Data Reciprocal】。


---
## Testing Questions of Variance

- 点击【Estimate the SRM Now!】，在【Table】窗口获得零模型结果。

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257657.png" width="100%" style="display: block; margin: auto;" /&gt;

---
## Testing Questions of Variance

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257692.png" width="50%" style="display: block; margin: auto;" /&gt;

**结果解读**：

- 近一半(46.3%)的寻求建议行为方差出现在关系层面。
- 研究结果表明个体水平的特征也有助于解释寻求建议行为的方差(参与者差异=44.7%，伴侣差异=9%，均P&lt;.001)。
- 群体特征对寻求建议行为无显著影响。

---
## Testing Questions of Reciprocit

- 点击【Estimate the SRM Now!】，在【Table】窗口获得零模型结果。

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257864.png" width="50%" style="display: block; margin: auto;" /&gt;

**结果解读**：

- 寻求建议行为的广义互惠不显著(r = .057, p = .663, n.s.)，无法证明寻求建议的人往往会吸引其他人来寻求建议。
- 寻求建议行为的双向相关是正显著的(r=.216，p&lt;.001)，这表明在给定的一对团队成员中存在相互的寻求建议行为。

---
## Testing Questions of Explanation

- 点击【Predictor Variables】，勾选【Predictor Variables in the Model】


![操作过程](https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257980.png)
---
## Testing Questions of Explanation
- 按需勾选【Check Predictor Variables】，勾选【Grand Mean Selected Variables】

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257400.png" width="60%" style="display: block; margin: auto;" /&gt;


---
## Testing Questions of Explanation
- 如果想直接显示变量含义，可勾选【Enter Names】，并输入对应内容。

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257239.png" width="100%" style="display: block; margin: auto;" /&gt;

---
## Testing Questions of Explanation
- 点击【Estimate the SRM Now!】，在【Table】窗口获得结果。

&lt;img src="https://tie-1315290370.cos.ap-beijing.myqcloud.com/TIE/202310082257507.png" width="60%" style="display: block; margin: auto;" /&gt;

**结果解读**：

- 行动者的主动性人格与寻求建议行为显著正相关(b=0.312，p=0.033)，表明主动性较高的人比主动性较低的人倾向于寻求更多的建议；

- 女性比男性更容易成为他人咨询行为的目标(b=0.173，p=0.038)；

- 性别的交互作用表明，人们更可能向同性伙伴而非异性伙伴寻求建议(b=0.144，p=.032)。

---
class: center, middle

# 谢谢

本幻灯片由 R 包 [**xaringan**](https://github.com/yihui/xaringan) 生成。

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
